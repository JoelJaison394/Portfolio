import{r as d}from"./index-9d53085f.js";function V(){return V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},V.apply(this,arguments)}function M(e,t){if(e==null)return{};var n={},i=Object.keys(e),s,r;for(r=0;r<i.length;r++)s=i[r],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}const C=new Map,b=new WeakMap;let m=0,k;function E(e){return e?(b.has(e)||(m+=1,b.set(e,m.toString())),b.get(e)):"0"}function N(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?E(e.root):e[t]}`).toString()}function j(e){let t=N(e),n=C.get(t);if(!n){const i=new Map;let s;const r=new IntersectionObserver(o=>{o.forEach(u=>{var h;const f=u.isIntersecting&&s.some(c=>u.intersectionRatio>=c);e.trackVisibility&&typeof u.isVisible>"u"&&(u.isVisible=f),(h=i.get(u.target))==null||h.forEach(c=>{c(f,u)})})},e);s=r.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:r,elements:i},C.set(t,n)}return n}function S(e,t,n={},i=k){if(typeof window.IntersectionObserver>"u"&&i!==void 0){const h=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:h,intersectionRect:h,rootBounds:h}),()=>{}}const{id:s,observer:r,elements:o}=j(n);let u=o.get(e)||[];return o.has(e)||o.set(e,u),u.push(t),r.observe(e),function(){u.splice(u.indexOf(t),1),u.length===0&&(o.delete(e),r.unobserve(e)),o.size===0&&(r.disconnect(),C.delete(s))}}const $=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function R(e){return typeof e.children!="function"}class T extends d.Component{constructor(t){super(t),this.node=null,this._unobserveCb=null,this.handleNode=n=>{this.node&&(this.unobserve(),!n&&!this.props.triggerOnce&&!this.props.skip&&this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=n||null,this.observeNode()},this.handleChange=(n,i)=>{n&&this.props.triggerOnce&&this.unobserve(),R(this.props)||this.setState({inView:n,entry:i}),this.props.onChange&&this.props.onChange(n,i)},this.state={inView:!!t.initialInView,entry:void 0}}componentDidUpdate(t){(t.rootMargin!==this.props.rootMargin||t.root!==this.props.root||t.threshold!==this.props.threshold||t.skip!==this.props.skip||t.trackVisibility!==this.props.trackVisibility||t.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve(),this.node=null}observeNode(){if(!this.node||this.props.skip)return;const{threshold:t,root:n,rootMargin:i,trackVisibility:s,delay:r,fallbackInView:o}=this.props;this._unobserveCb=S(this.node,this.handleChange,{threshold:t,root:n,rootMargin:i,trackVisibility:s,delay:r},o)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){if(!R(this.props)){const{inView:r,entry:o}=this.state;return this.props.children({inView:r,entry:o,ref:this.handleNode})}const t=this.props,{children:n,as:i}=t,s=M(t,$);return d.createElement(i||"div",V({ref:this.handleNode},s),n)}}function W({threshold:e,delay:t,trackVisibility:n,rootMargin:i,root:s,triggerOnce:r,skip:o,initialInView:u,fallbackInView:h,onChange:f}={}){var c;const[p,x]=d.useState(null),g=d.useRef(),[v,I]=d.useState({inView:!!u,entry:void 0});g.current=f,d.useEffect(()=>{if(o||!p)return;let l;return l=S(p,(O,w)=>{I({inView:O,entry:w}),g.current&&g.current(O,w),w.isIntersecting&&r&&l&&(l(),l=void 0)},{root:s,rootMargin:i,threshold:e,trackVisibility:n,delay:t},h),()=>{l&&l()}},[Array.isArray(e)?e.toString():e,p,s,i,r,o,n,h,t]);const y=(c=v.entry)==null?void 0:c.target,_=d.useRef();!p&&y&&!r&&!o&&_.current!==y&&(_.current=y,I({inView:!!u,entry:void 0}));const a=[x,v.inView,v.entry];return a.ref=a[0],a.inView=a[1],a.entry=a[2],a}export{T as I,W as u};
